version: 1.10.0.{build}
branches:
  only:
  - master
max_jobs: 4
image: Visual Studio 2019
configuration:
- Debug
- Release
platform:
- x64
- Win32
environment: {}
build:
  project: googletest\msvc\2019\gtest.sln
  parallel: true
  verbosity: normal
before_test:
- cmd: >-

    @echo off
    echo APPVEYOR_BUILD_FOLDER: %APPVEYOR_BUILD_FOLDER%
    echo "Calling %APPVEYOR_BUILD_FOLDER%\googletest\output\windows\vs\%PlatformToolset%\%PLATFORM%\%CONFIGURATION%"
    dir %APPVEYOR_BUILD_FOLDER%\googletest\output\windows/vs/%PlatformToolset%/%PLATFORM%/%CONFIGURATION%

on_finish:
- ps: (new-object net.webclient).UploadFile("https://ci.appveyor.com/api/testresults/junit/$($env:APPVEYOR_JOB_ID)", (Resolve-Path .\gtest_UT_$($env:CONFIGURATION)_$($env:PLATFORM).xml))
artifacts:
- path: googletest\output
  name: googletest_binaries_$(Configuration)_$(Platform)-$(appveyor_build_version)
- path: googletest\include
  name: googletest_include-$(appveyor_build_version)
deploy:
- provider: GitHub
  tag: release-$(appveyor_build_version)
  auth_token:
    secure: FL0q/kJ4tkpO7htGNFPeOMdG3nhWjvNWQ98NtvtWbChJUYL82dpnbokqq91Oga/I
  repository: munsingh/googletest
  artifact: googletest_binaries_$(Configuration)_$(Platform)-$(appveyor_build_version),googletest_include-$(appveyor_build_version)
  draft: false
  prerelease: false
  force_update: false